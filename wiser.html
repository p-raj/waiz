<html>
    <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1">


            <title>WAIZ</title>

            <!-- CSS -->
            <!--fonts-->
            <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500|Roboto+Slab:400,700|Roboto:400,500" rel="stylesheet"> 
            <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
            <!--fonts-->
            <link rel="stylesheet" href="./css/mini.css">
            <link rel="stylesheet" href="./css/main.css">
            <!-- CSS -->
            
            <!-- JS -->
            <script type="text/javascript" src="./node_modules/pouchdb/dist/pouchdb.js"></script>
            <script type="text/javascript" src="./node_modules/pouchdb/dist/pouchdb.find.js"></script>
            <script type="text/javascript" src="./node_modules/handlebars/dist/handlebars.js"></script>
            <script type="text/javascript" src="./js/main.js"></script>
            <!-- JS -->
    </head>
    <body>

        <!--BEGIN: Title Section-->
        <div class='row'>
            <!--BEGIN: Project Name-->
            <div class="col-lg-2 col-md-2">
                <h4 class="hidden-sm">
                    <a href='index.html'>
                        WAIZ
                    </a>
                <span class="hidden-md">
                    <small>(That's how wise is pronounced)</small>
                    <small>Project Status: MVP</small>
                </span>
                    
                </h4>
                <!--BEGIN: REAL DEAL - the dimension important for the user-->
            <div>
                <p>
                    Filter:
                    <select>
                        <option>1 min</option>
                        <option>10 min</option>
                        <option>30 min</option>
                        <option>60 min</option>
                    </select>
                </p>
            </div>
            <!--END: Data Dimensions or simply the filters-->
            </div>
            <!--END: Project Name-->
            <!--BEGIN: Query Results-->
            <div id='title' class="col-lg-10 col-md-10 col-sm-12">
                <!-- HANDLEBARS -->
                <!-- title-template -->
            </div>
            <!--END: Query Results-->
    
        </div>
        <!--END: Title Section-->

        <div id='content'>
            <!--BEGIN: RESULT: Would be in for loop-->
            
            <!--HANDLEBARS-->
            <!-- result-template -->

            <!--END: RESULT: end loop-->
        </div>
    </body>
    <footer>
        <p>
            <h4>
                You think you can do one better?
            </h4>
            <form>
                <label for='summary_link'>A better link</label>
                <input type='text' name='summary_link'>
                
                <label for='why_summary_link'>Why?</label>
                <input type='text' name='why_summary_link'>
                
                <input type="submit" name="submit" title="submit">
            </form>
        </p>   
    </footer>
    
    <script id="title-template" type="text/x-handlebars-template">
        <div class="row">
                <!--BEGIN: Query Topic-->
                <div class="col-sm-6">
                    <h2>
                        <a href='{{data.wisdom.wisdom.metadata.stores.goodreads}}'>
                            {{data.wisdom.wisdom.title}}
                        </a>
                        <small>{{data.wisdom.wisdom.sub-title}}</small>
                    </h2>
                </div>
                <!--END: Query Topic-->

                <!--BEGIN: Topic Author-->
                <div class="col-sm-6">
                    <h2>
                        <a href='{{data.wisdom.author.social.twitter.link}}'>@{{data.wisdom.author.social.twitter.username}}</a>
                        <small>{{data.wisdom.author.name}}</small>
                    </h2>
                </div>
                <!--END: Topic Author-->

                <!--BEGIN: Main Idea-->
                <p>
                    {{data.wisdom.wisdom.metadata.summary}}
                </p>
                <!--END: Main Idea-->
            </div>
    </script>

    <script id="result-template" type="text/x-handlebars-template">
        <!--BEGIN: SAMPLE RESULT 1-->
        {{#each data.wisdom.wisdom.metadata.wisdom}}
            <div class='result row'>
            <!--BEGIN: Content-->

                <!--BEGIN: Author & source: Always a priority -->

                    <!--BEGIN: AUTHOR-->
                    <div class="col-lg-2 col-md-2 col-sm-12">
                        <h5>
                            <a href='{{author.social.twitter.link}}'>@{{author.social.twitter.username}}</a>
                            <small>{{author.name}}</small>
                        </h5>
                            
                        </span>
                    </div>
                    <!--END: AUTHOR-->

                    <!--BEGIN: Main Highlight for the content-->
                    <div class="col-lg-10 col-md-10 col-sm-12">
                        <p>
                            {{summary}}
                        </p>
                    </div>
                    <!--END: Main Highlight for the content-->

                    <!-- BEGIN: Reader's Reaction-->
                    <div class='col-lg-12 col-md-12 col-sm-12 reaction'>
                        <span>
                            <a href='{{link}}'><i class="fas fa-link"></i></a>
                        </span>
                        <span><i class="far fa-heart featureunavailable text-red"></i></span>
                        <span><i class="far fa-thumbs-down featureunavailable text-orange"></i></span>
                    </div>
                <!-- END: Reader's Reaction-->

                <!--END: Author & source: Always a priority -->
                <!--BEGIN: Content Metadata -->
                
                <div class="row dimension">
                    <span><b>Dimensions:</b></span>
                    {{#each dimensions}}
                        <span class='shaded {{#if primary}}primary{{/if}}'>{{display}}: {{value}} {{unit}}</span>
                    {{/each}}
                </div>

                <!--END: Content Metadata -->
            <!--END: Content-->
        </div>
        {{/each}}
        <!--END: SAMPLE RESULT 1-->
    </script>
    
    
    <script type="text/javascript">
        function set_title(context) {
            var source   = document.getElementById("title-template").innerHTML;
            var template = Handlebars.compile(source);
            var html    = template(context);
            // TITLE
            document.getElementById('title').insertAdjacentHTML('beforeend', html);
        }

        function set_results(context) {
            var source   = document.getElementById("result-template").innerHTML;
            var template = Handlebars.compile(source);
            var html    = template(context);
            // RESULTS
            document.getElementById('content').insertAdjacentHTML('beforeend', html);
        }
        // print_template 
        function set_templates(results) {
            var context = results[0]; // get only the first result
            set_title(context);
            set_results(context);
        }
    </script>

    <script type="text/javascript">
        var db = new PouchDB('wise');
        var remoteCouch = false;

        filterWisdomByTitle(
            db, 
            {
                query: {
                    title: "Antifragile"
                }
            },
            set_templates
        );
    </script>

</html>